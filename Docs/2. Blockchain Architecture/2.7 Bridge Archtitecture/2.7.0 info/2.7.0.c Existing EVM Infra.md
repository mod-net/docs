# Findings

- __EVM support (Frontier)__: Present and wired, but gated behind the `testnet` feature.
  - Runtime dependencies include Frontier pallets: `pallet-evm`, `pallet-ethereum`, `pallet-base-fee`, `pallet-dynamic-fee`, `pallet-evm-chain-id`, and precompiles (`modexp`, `sha3fips`, `simple`). See [runtime/Cargo.toml](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/Cargo.toml:0:0-0:0) lines 66–81 and `std` features at lines 136–148.
  - Runtime wiring is conditional on `#[cfg(feature = "testnet")]`:
    - Pallets included: `EVM`, `Ethereum`, `BaseFee`, `DynamicFee` in `construct_runtime!` when `testnet` is enabled ([runtime/src/lib.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/lib.rs:0:0-0:0) lines 651–660).
    - EVM configuration: `pallet_evm::Config` sets `CallOrigin` and `WithdrawOrigin` to [EnsureCuratorAddressTruncated](cci:2://file:///home/com/repos/comai/subspace-fork/runtime/src/lib.rs:708:0-708:41), `AddressMapping = HashedAddressMapping<BlakeTwo256>`, `Currency = Balances`, chain ID via `pallet_evm_chain_id`, custom `WeightPerGas`, gas limit, and precompile set ([FrontierPrecompiles](cci:2://file:///home/com/repos/comai/subspace-fork/runtime/src/precompiles/mod.rs:32:0-32:50)). See [runtime/src/lib.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/lib.rs:0:0-0:0) lines 553–577.
    - Chain ID: `9461` ([runtime/src/lib.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/lib.rs:0:0-0:0) lines 518–523).
    - Ethereum transaction type / self-contained extrinsics: enabled only under `testnet` ([runtime/src/lib.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/lib.rs:0:0-0:0) lines 772–785, 797–854).
  - __RPC and offchain services__: Full Frontier RPC stack present:
    - RPC modules for `eth`, `net`, `web3`, `debug`, `eth_subscribe`, `eth_filter` configured in [node/src/rpc/eth.rs](cci:7://file:///home/com/repos/comai/subspace-fork/node/src/rpc/eth.rs:0:0-0:0) (notably [create_eth()](cci:1://file:///home/com/repos/comai/subspace-fork/node/src/rpc/eth.rs:68:0-205:1) wiring of `fc_rpc::Eth`, `EthFilter`, `EthPubSub`, `Net`, `Web3`, `Debug`).
    - Frontier DB and mapping sync workers set up in [node/src/eth.rs](cci:7://file:///home/com/repos/comai/subspace-fork/node/src/eth.rs:0:0-0:0) ([spawn_frontier_tasks()](cci:1://file:///home/com/repos/comai/subspace-fork/node/src/eth.rs:107:0-188:1)), supporting both KeyValue and SQL backends.

- __Precompiles__: Custom precompile set is defined and used under `testnet`.
  - Standard: `ecrecover`, `sha256`, `ripemd160`, `identity`, `modexp`, plus `sha3fips256` and `ecrecover_public_key`.
  - Custom: `balance_transfer`, `staking`, and an `ed25519_verify` precompile.
  - See [runtime/src/precompiles/mod.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/precompiles/mod.rs:0:0-0:0), with modules [balance_transfer.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/precompiles/balance_transfer.rs:0:0-0:0), [staking.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/precompiles/staking.rs:0:0-0:0), [ed25519.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/precompiles/ed25519.rs:0:0-0:0) discovered in [runtime/src/precompiles/](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/precompiles:0:0-0:0).
  - The set is provided via [FrontierPrecompiles<Runtime>](cci:2://file:///home/com/repos/comai/subspace-fork/runtime/src/precompiles/mod.rs:32:0-32:50) and hooked with `PrecompilesValue` ([runtime/src/lib.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/lib.rs:0:0-0:0) lines 545–551).

- __Deployment/Call origin restrictions__: Contract deploy/call origins are gated.
  - [EnsureCuratorAddressTruncated](cci:2://file:///home/com/repos/comai/subspace-fork/runtime/src/lib.rs:708:0-708:41) checks the H160 address matches the first 20 bytes of the Substrate `AccountId32` and respects `pallet_governance::RestrictContractDeploy`—if enabled, only the `Curator` can deploy ([runtime/src/lib.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/lib.rs:0:0-0:0) lines 709–737).
  - This is applied to `pallet_evm::Config` as both `CallOrigin` and `WithdrawOrigin` ([runtime/src/lib.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/lib.rs:0:0-0:0) lines 560–563).

- __Asset/decimals mapping for EVM balances__: EVM-substrate balance conversions use `EVM_DECIMALS_FACTOR = 1_000_000_000` (1e9), implemented by [EvmBalanceConverter](cci:2://file:///home/com/repos/comai/subspace-fork/runtime/src/lib.rs:690:0-690:31) ([runtime/src/lib.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/lib.rs:0:0-0:0) lines 688–707).

- __Wasm contracts (ink!/pallet-contracts)__: Not present.
  - No `pallet-contracts` in [runtime/Cargo.toml](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/Cargo.toml:0:0-0:0), no references in [runtime/src/lib.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/lib.rs:0:0-0:0). Grep found no usage of `pallet-contracts` or `contracts::`.

- __Bridging/XCM__: Not enabled in runtime.
  - No XCM pallets (`pallet-xcm`, `xcm-executor`) in [runtime/Cargo.toml](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/Cargo.toml:0:0-0:0).
  - No XCM configuration in [runtime/src/lib.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/lib.rs:0:0-0:0).
  - Repo contains XCM crates in target/spec files, but they’re not wired into the runtime.

# Assessment

- __EVM smart contracts__: Supported via Frontier when building with `--features testnet`. Includes EVM execution, gas/fee market (BaseFee/DynamicFee), Ethereum RPC compatibility, and a set of standard + custom precompiles. Contract deployment/calls may be restricted to a governance “Curator” depending on the `RestrictContractDeploy` flag.

- __Wasm smart contracts (ink!)__: Not supported; no `pallet-contracts`.

- __Bridging/XCM__: Not configured; no cross-chain message passing or bridge pallets present.

# Pointers to key files

- [runtime/Cargo.toml](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/Cargo.toml:0:0-0:0): Frontier dependency flags and features.
- [runtime/src/lib.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/lib.rs:0:0-0:0): EVM parameters, precompile set, origin restrictions, `construct_runtime!`.
- [runtime/src/precompiles/mod.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/precompiles/mod.rs:0:0-0:0) (+ [balance_transfer.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/precompiles/balance_transfer.rs:0:0-0:0), [staking.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/precompiles/staking.rs:0:0-0:0), [ed25519.rs](cci:7://file:///home/com/repos/comai/subspace-fork/runtime/src/precompiles/ed25519.rs:0:0-0:0)): Precompiles.
- [node/src/rpc/eth.rs](cci:7://file:///home/com/repos/comai/subspace-fork/node/src/rpc/eth.rs:0:0-0:0) and [node/src/eth.rs](cci:7://file:///home/com/repos/comai/subspace-fork/node/src/eth.rs:0:0-0:0): Frontier RPC wiring and background tasks.

# Recommended Actions

- __Enable EVM on your build__: compile with `--features testnet` to activate EVM pallets and RPC.
- __Decide deployment policy__: review `pallet_governance::RestrictContractDeploy` and `Curator` usage if you need public deployment.
- __If you need ink!/Wasm__: add and configure `pallet-contracts`.
- __If you need bridging/XCM__: add XCM pallets (`pallet-xcm`, executor), configure locations/fees, and wire node-side helpers.

Summary: The codebase provides an EVM-compatible testnet runtime with Frontier and custom precompiles, but no ink!/pallet-contracts and no bridging/XCM configured.